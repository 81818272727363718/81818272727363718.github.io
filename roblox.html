<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Roblox Neon Lookup</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&family=Orbitron:wght@600&display=swap" rel="stylesheet">
<style>
body{margin:0;font-family:Inter;background:#060713;color:#e9faff;padding:20px}
h1{text-align:center;font-family:Orbitron;margin-top:0}
.controls{display:flex;flex-wrap:wrap;gap:10px;margin:15px 0}
input{flex:1;min-width:180px;padding:10px;border-radius:10px;border:1px solid #3af2ff;background:#10121d;color:#fff}
button{padding:10px 16px;border-radius:10px;border:1px solid #3af2ff;background:#0d1620;color:#fff;font-weight:600;cursor:pointer}
button:hover{background:#163040}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(230px,1fr));gap:15px}
.card{background:#0c1020;border:1px solid #2ad4ff;padding:14px;border-radius:12px;box-shadow:0 0 18px rgba(0,255,255,0.15)}
#badgePage{display:none;margin-top:20px}
#badgeResultPage{margin-top:15px}
#loadingOverlay{position:fixed;inset:0;background:rgba(0,0,0,0.6);display:none;align-items:center;justify-content:center;z-index:200}
.spinner{width:60px;height:60px;border-radius:50%;border:4px solid rgba(0,255,255,0.2);border-top-color:#00fff7;animation:spin .7s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}
#popupOverlay{position:fixed;inset:0;background:rgba(0,0,0,0.6);display:none;align-items:center;justify-content:center;z-index:150}
.popup{background:#0b0f1d;border:1px solid #4efaff;padding:16px;border-radius:12px;width:90%;max-width:480px;max-height:70vh;overflow:auto}
.popup-item{padding:6px 0;border-bottom:1px solid #233}
.popup-item:hover{color:#3af2ff;cursor:pointer}
#popupSearch{width:100%;padding:10px;margin-bottom:10px;border-radius:10px;border:1px solid #3af2ff;background:#141726;color:#fff}
#suggestionsList{display:none;position:absolute;background:#0c1020;border:1px solid #2ad4ff;width:100%;border-radius:10px;z-index:20}
.suggestion-item{padding:8px;cursor:pointer}
.suggestion-item:hover{background:#18222f}
</style>
</head>
<body>

<h1>Roblox Neon Lookup</h1>

<div id="mainPage">
  <div class="controls">
    <input id="rbxUser" placeholder="Roblox username">
    <button id="rbxFetch">Fetch Profile</button>
    <button id="goBadgePage">Badge Award Checker</button>
  </div>

  <div id="suggestions"><div id="suggestionsList"></div></div>

  <div id="rbxResults" class="grid"></div>
</div>

<!-- BADGE PAGE -->
<div id="badgePage">
  <h2>Badge Award Checker</h2>
  <div class="controls">
    <input id="badgeUser2" placeholder="Username">
    <input id="badgeId2" placeholder="Badge ID">
    <button id="badgeCheckBtn2">Check Award</button>
  </div>

  <div class="controls">
    <input id="webhookUrl" placeholder="Discord Webhook URL (optional)">
    <button id="sendToWebhook">Send Result</button>
  </div>

  <div id="badgeResultPage" class="card" style="display:none"></div>

  <button id="backToMain" style="margin-top:20px">Back</button>
</div>

<!-- POPUP -->
<div id="popupOverlay"><div class="popup">
  <h3 id="popupTitle"></h3>
  <input id="popupSearch" placeholder="Search...">
  <div id="popupContent"></div>
  <button onclick="closePopup()">Close</button>
</div></div>

<!-- LOADING -->
<div id="loadingOverlay"><div class="spinner"></div></div>

<script>
const proxyWrap=u=>`https://corsproxy.io/?${encodeURIComponent(u)}`;
async function fetchJson(url,opts){const r=await fetch(url,{...opts,mode:'cors'});if(!r.ok)throw new Error(r.status);return r.json();}
const usernameEndpoints=[
 'https://users.roproxy.com/v1/usernames/users',
 'https://users.rprxy.xyz/v1/usernames/users',
 proxyWrap('https://users.roblox.com/v1/usernames/users')
];
async function lookupUser(name){
 const p={usernames:[name]};
 for(const u of usernameEndpoints){
  try{
   const d=await fetchJson(u,{method:"POST",body:JSON.stringify(p)});
   if(d?.data?.length)return d.data[0];
  }catch{}
 }
 throw new Error("Unable to reach Roblox services");
}

/* PAGE SWITCHING */
const mainPage=document.getElementById("mainPage");
const badgePage=document.getElementById("badgePage");
document.getElementById("goBadgePage").onclick=()=>{
 mainPage.style.display="none";
 badgePage.style.display="block";
};
document.getElementById("backToMain").onclick=()=>{
 badgePage.style.display="none";
 mainPage.style.display="block";
};

/* LOADING */
const loading=document.getElementById("loadingOverlay");
const showLoading=s=>loading.style.display=s?'flex':'none';

/* POPUP */
let popupItems=[],popupOptions={};
function showPopup(title,items,opt={}) {
 popupItems=items; popupOptions=opt;
 document.getElementById("popupTitle").textContent=title;
 document.getElementById("popupOverlay").style.display="flex";
 renderPopup(items);
 document.getElementById("popupSearch").oninput=()=>{
  const q=document.getElementById("popupSearch").value.toLowerCase();
  renderPopup(items.filter(i=>i.toLowerCase().includes(q)));
 };
}
function renderPopup(list){
 document.getElementById("popupContent").innerHTML=list.map(i=>`<div class="popup-item" data-v="${i}">${i}</div>`).join('');
 document.querySelectorAll(".popup-item").forEach(el=>{
  if(popupOptions.onClick)el.onclick=()=>{popupOptions.onClick(el.dataset.v);closePopup();}
 });
}
function closePopup(){document.getElementById("popupOverlay").style.display="none";}

/* SUGGESTIONS */
const inputEl=document.getElementById("rbxUser"),suggestList=document.getElementById("suggestionsList");
let suggestTimeout=null;
inputEl.oninput=()=>{
 const q=inputEl.value.trim();
 if(suggestTimeout)clearTimeout(suggestTimeout);
 if(q.length<3){suggestList.style.display="none";return;}
 suggestTimeout=setTimeout(()=>searchSuggest(q),200);
};
async function searchSuggest(q){
 let d=null;try{
  d=await fetchJson(proxyWrap(`https://users.roblox.com/v1/users/search?keyword=${q}&limit=10`));
 }catch{return;}
 if(!d?.data?.length){suggestList.style.display="none";return;}
 suggestList.innerHTML=d.data.map(u=>`<div class="suggestion-item" data-u="${u.name}">${u.displayName} (@${u.name})</div>`).join('');
 suggestList.style.display="block";
 document.querySelectorAll(".suggestion-item").forEach(el=>el.onclick=()=>{inputEl.value=el.dataset.u;suggestList.style.display="none";renderRoblox(el.dataset.u);});
}

/* MAIN PROFILE LOOKUP */
document.getElementById("rbxFetch").onclick=()=>renderRoblox(inputEl.value.trim());
async function renderRoblox(username){
 if(!username)return;
 const out=document.getElementById("rbxResults");
 out.innerHTML="<div class='card'>Loading...</div>";
 showLoading(true);
 try{
  const user=await lookupUser(username);const id=user.id;
  async function tryMulti(list){
   for(const u of list){try{return await fetchJson(u);}catch{}}
   return null;
  }
  const profile=await tryMulti([
    `https://users.roproxy.com/v1/users/${id}`,
    `https://users.rprxy.xyz/v1/users/${id}`,
    proxyWrap(`https://users.roblox.com/v1/users/${id}`)
  ]);
  const friends=await tryMulti([
    `https://friends.roproxy.com/v1/users/${id}/friends?limit=200`,
    `https://friends.rprxy.xyz/v1/users/${id}/friends?limit=200`,
    proxyWrap(`https://friends.roblox.com/v1/users/${id}/friends?limit=200`)
  ]);
  const groups=await tryMulti([
    `https://groups.roproxy.com/v2/users/${id}/groups/roles`,
    `https://groups.rprxy.xyz/v2/users/${id}/groups/roles`,
    proxyWrap(`https://groups.roblox.com/v2/users/${id}/groups/roles`)
  ]);
  const badges=await tryMulti([
    `https://badges.roproxy.com/v1/users/${id}/badges?limit=100`,
    `https://badges.rprxy.xyz/v1/users/${id}/badges?limit=100`,
    proxyWrap(`https://badges.roblox.com/v1/users/${id}/badges?limit=100`)
  ]);

  const friendsList=(friends?.data||[]).map(f=>f.name);
  const groupsList=(groups?.data||[]).map(g=>`${g.group.name} â€” ${g.role?.name||"Member"}`);
  const badgeObjs=(badges?.data||[]).map(b=>b.name);

  out.innerHTML="";

  function card(title,body,list=null){
    const c=document.createElement("div");c.className="card";
    c.innerHTML=`<h3>${title}</h3><p>${body}</p>`;
    if(list&&list.length){
      const b=document.createElement("button");b.textContent="Show All";
      b.onclick=()=>showPopup(title,list,{onClick:name=>renderRoblox(name)});
      c.appendChild(b);
    }
    out.appendChild(c);
  }

  card("Profile",`${profile.displayName}<br>@${profile.name}`);
  card("Friends",friendsList.slice(0,6).join(", "),friendsList);
  card("Groups",groupsList.slice(0,4).join("<br>"),groupsList);
  if(badgeObjs.length)card("Badges",badgeObjs.slice(0,5).join(", "),badgeObjs);

 }catch(e){
  out.innerHTML=`<div class='card'>${e.message}</div>`;
 }
 showLoading(false);
}

/* BADGE AWARD CHECKER */
let lastBadge=null;
document.getElementById("badgeCheckBtn2").onclick=async()=>{
 const u=document.getElementById("badgeUser2").value.trim();
 const b=Number(document.getElementById("badgeId2").value.trim());
 const box=document.getElementById("badgeResultPage");
 if(!u||!b){box.style.display="block";box.innerHTML="<h3>Error</h3><p>Enter username + badge ID</p>";return;}
 box.style.display="block";box.innerHTML="<h3>Checking...</h3>";
 try{
  const usr=await lookupUser(u);const id=usr.id;
  const urls=[
   `https://badges.roproxy.com/v1/users/${id}/badges/awarded-dates?badgeIds=${b}`,
   `https://badges.rprxy.xyz/v1/users/${id}/badges/awarded-dates?badgeIds=${b}`,
   proxyWrap(`https://badges.roblox.com/v1/users/${id}/badges/awarded-dates?badgeIds=${b}`)
  ];
  let d=null;for(const u2 of urls){try{d=await fetchJson(u2);break;}catch{}}
  const e=d?.data?.find(x=>x.badgeId==b);
  if(!e){box.innerHTML=`<h3>Badge Award</h3><p>${u} never earned badge ${b}</p>`;lastBadge=null;return;}
  const date=new Date(e.awardedDate).toLocaleString();
  const r=`User: ${u}\nBadge: ${b}\nDate: ${date}`;
  box.innerHTML=`<h3>Badge Award</h3><p>${r.replace(/\n/g,"<br>")}</p>`;
  lastBadge=r;
 }catch(err){box.innerHTML=`<h3>Error</h3><p>${err.message}</p>`;lastBadge=null;}
};

/* WEBHOOK SEND */
document.getElementById("sendToWebhook").onclick=async()=>{
 const url=document.getElementById("webhookUrl").value.trim();
 if(!url)return alert("Enter webhook URL");
 if(!lastBadge)return alert("No result to send");
 await fetch(url,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:lastBadge})});
 alert("Sent!");
};
</script>
</body>
</html>
